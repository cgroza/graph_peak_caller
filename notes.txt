


vg filter -r 0.9 -fu -s 2 -o 0 -q 15 --defray-ends 999 -x cactus-mhc.xg ENCFF000WVQ.gam > ENCFF000WVQ_filtered.gam &


Sjekke:
    - Antall peaks funnet med signifikant motif match
    - Antall like peaks funnet (basert på et krav for likhet)
        - Antall peaks funnet av den ene og ikke den andre
    - IDR mellom replikater

Artikler som benchmarker:
Triform peak caller: https://bmcbioinformatics.biomedcentral.com/articles/10.1186/1471-2105-13-176

http://journals.plos.org/plosone/article?id=10.1371/journal.pone.0011471 (inneholder link til read datasett + motifer for NRSF, GABP, FoxA1)
    - Inneholder også qPCR validated peaks


Konvertere bam til fastq og plukke ut region:

samtools index file.bam
samtools view -bh file.bam "chr6:28510119-33480577" > file_mhc.bam
bamtools convert -in file_mhc.bam -format fastq > file.fastq &


Få fasta fil med reads som ikke mapper unikt/bra utenfor MHC

input:
    linear.bam (original fasta file mapped to linear genome),
    orig.fasta (original fasta file)

output:
    output.fasta (fasta reads not mapping well outside region)

samtools index linear.bam

samtools
# Filtrer reads med høy mappingn score (unikt mappet?)
samtools view -bq 30 file.bam > filtered.bam


# Fjerne reads utenfor MHC
# Bruker ngsutils sin bamutils
bamutils filter filtered.bam filtered_outside_mhc.bam -exclude chr6:28510119-33480577

# Konverter til fastq
bamtools convert -in file_mhc.bam -format fastq > file.fastq &

# Lag en fil med sekvensid per linje på det som skal fjernes
grep @ filtered_outside_mhc.fastq > filtered_outside_mhc.ids
sed -e s/@//g -i filtered_outside_mhc.ids


# Fjern reads fra opprinnelig fastq som er i den fastq-en
på abel: module load qiime
filter_fasta.py -f input.fasta -o output.fasta ----subject_fasta_fp filtered_outside_mhc.fasta --negate



MAPPING:
Denne tar også vare på secondary mappings:
NB: Krever at det ligger en *.gcsa.lcp fil i samme mappe.

vg map -f fil.fastq.gz -g haplo1kg50-mhc.gcsa -x haplo1kg50-mhc.xg haplo1kg50-mhc.vg -M 2 > mapped3.gam &
